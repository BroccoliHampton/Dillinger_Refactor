<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Dillinger Outlaw Space Commando 1995</title>
    
    <!-- Farcaster Frame Meta -->
    <meta name="fc:frame" content="vNext">
    <meta name="fc:frame:image" content="https://dillinger-game.vercel.app/preview.png">
    <meta name="fc:frame:button:1" content="Play Game">
    <meta name="fc:frame:post_url" content="https://dillinger-game.vercel.app">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Press+Start+2P&family=VT323&display=swap" rel="stylesheet">
    
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Tone.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
    
    <!-- Main Styles -->
    <link rel="stylesheet" href="/css/main.css">
    
    <!-- Main Script (ES Module) -->
    <script type="module" src="/js/main.js"></script>
</head>
<body class="overflow-x-hidden">
    <!-- Background Starfield -->
    <div id="starfield"></div>

    <!-- ========================================= -->
    <!-- MINT OVERLAY (Start Screen) -->
    <!-- ========================================= -->
    <div id="mint-overlay" class="fixed inset-0 z-50 flex flex-col items-center justify-center bg-black/90 p-4">
        <div class="text-center max-w-md">
            <h1 class="font-title text-2xl md:text-3xl text-yellow-400 mb-2 tracking-wider" style="text-shadow: 0 0 10px #facc15;">
                DILLINGER
            </h1>
            <p class="font-title text-xs text-green-400 mb-6">OUTLAW SPACE COMMANDO 1995</p>
            
            <div class="wireframe-container">
                <svg id="wireframe-ship-0" class="wireframe-ship-part" viewBox="0 0 100 100">
                    <polygon points="50,10 20,90 50,70 80,90"/>
                    <line x1="50" y1="10" x2="50" y2="70"/>
                    <line x1="20" y1="90" x2="80" y2="90"/>
                </svg>
                <svg id="wireframe-ship-45" class="wireframe-ship-part" viewBox="0 0 100 100">
                    <polygon points="50,10 20,90 50,70 80,90"/>
                    <line x1="50" y1="10" x2="50" y2="70"/>
                    <line x1="20" y1="90" x2="80" y2="90"/>
                </svg>
                <svg id="wireframe-ship-90" class="wireframe-ship-part" viewBox="0 0 100 100">
                    <polygon points="50,10 20,90 50,70 80,90"/>
                    <line x1="50" y1="10" x2="50" y2="70"/>
                    <line x1="20" y1="90" x2="80" y2="90"/>
                </svg>
                <svg id="wireframe-ship-135" class="wireframe-ship-part" viewBox="0 0 100 100">
                    <polygon points="50,10 20,90 50,70 80,90"/>
                    <line x1="50" y1="10" x2="50" y2="70"/>
                    <line x1="20" y1="90" x2="80" y2="90"/>
                </svg>
            </div>
            
            <p class="text-sm text-gray-400 mb-6 px-4">
                Pilot The Outrider across 1,000,000 lightyears. Craft solar sails, manage your photon reactor, and evade the law.
            </p>
            
            <button id="mint-button" class="retro-button font-title text-sm py-3 px-8 rounded text-green-400 hover:text-white">
                [ LAUNCH MISSION ]
            </button>
        </div>
    </div>

    <!-- ========================================= -->
    <!-- LOADING SPINNER -->
    <!-- ========================================= -->
    <div id="loading-spinner" class="fixed inset-0 z-40 flex flex-col items-center justify-center bg-black/80 hidden">
        <div class="spinner"></div>
        <p class="mt-4 font-title text-xs text-green-400">INITIALIZING SYSTEMS...</p>
    </div>

    <!-- ========================================= -->
    <!-- GAME HEADER -->
    <!-- ========================================= -->
    <header id="game-header" class="w-full max-w-lg mx-auto p-2 flex justify-between items-center hidden">
        <p id="user-id-display" class="text-xs text-gray-500 hidden">FID: ---</p>
        <button id="mute-button" class="audio-control-button">
            <i id="mute-icon" class="fas fa-volume-up"></i>
        </button>
    </header>

    <!-- ========================================= -->
    <!-- MAIN GAME CONTAINER -->
    <!-- ========================================= -->
    <main id="game-container" class="w-full max-w-lg mx-auto p-2 hidden">
        <div id="game-area">

            <!-- ===== VITALS TAB ===== -->
            <section id="vitals-tab-content" class="tab-content active">
                <div class="retro-border secondary-panel-bg rounded-lg p-3 mb-3">
                    <div class="flex justify-between items-center mb-2">
                        <h2 class="font-title text-xs text-green-400">// SYSTEM VITALS</h2>
                        <span id="system-mode-display" class="text-xs font-bold" style="color: var(--neon-green);">STANDARD</span>
                    </div>

                    <!-- Stats Grid -->
                    <div class="grid grid-cols-2 gap-2 text-xs">
                        <!-- Photons -->
                        <div class="stat-grid-item photons-gauge rounded p-2">
                            <p class="text-yellow-400 font-bold">PHOTONS</p>
                            <p id="photons-display" class="text-xl text-white font-bold">0</p>
                            <p id="photon-rate-display" class="text-yellow-300 text-xs">+0/s</p>
                            <div id="photons-activity-gauge" class="activity-gauge"></div>
                        </div>
                        <!-- Sun Intensity -->
                        <div class="stat-grid-item btc-glow rounded p-2">
                            <p class="text-orange-400 font-bold">SUN INTENSITY</p>
                            <p id="btc-price-display" class="text-xl text-white font-bold">500,000</p>
                            <p class="text-orange-300 text-xs">lux</p>
                            <div id="sun-activity-gauge" class="activity-gauge"></div>
                        </div>
                        <!-- Substrate -->
                        <div class="stat-grid-item substrate-glow rounded p-2">
                            <p class="text-pink-400 font-bold">ETH SUBSTRATE</p>
                            <p id="eth-price-display" class="text-xl text-white font-bold">4,000</p>
                            <p class="text-pink-300 text-xs">gwei</p>
                            <div id="substrate-activity-gauge" class="activity-gauge electric-gauge"></div>
                        </div>
                        <!-- Lightyears -->
                        <div class="stat-grid-item lightyears-glow rounded p-2">
                            <p class="text-cyan-400 font-bold">LIGHTYEARS</p>
                            <p id="lightyears-display" class="text-xl text-white font-bold">0</p>
                            <p id="lightyear-rate-display" class="text-cyan-300 text-xs">~0/s</p>
                            <div id="lightyears-activity-gauge" class="activity-gauge"></div>
                        </div>
                    </div>

                    <!-- Progress Bar -->
                    <div class="mt-3">
                        <div class="flex justify-between text-xs mb-1">
                            <span class="text-gray-400">PROGRESS TO FREEDOM</span>
                            <span class="text-pink-400">1,000,000 LY</span>
                        </div>
                        <div class="progress-bar rounded-full overflow-hidden">
                            <div id="progress-fill" class="progress-fill h-full rounded-full" style="width: 0%;"></div>
                        </div>
                    </div>

                    <!-- Warrants -->
                    <div class="mt-3 text-center">
                        <p id="warrants-display" class="text-red-500 font-bold text-sm">
                            <i class="fas fa-skull-crossbones mr-2"></i> 0
                        </p>
                        <p class="text-gray-500 text-xs">OUTSTANDING WARRANTS</p>
                    </div>
                </div>

                <!-- Log Display -->
                <div class="retro-border secondary-panel-bg rounded-lg p-3">
                    <h2 class="font-title text-xs text-green-400 mb-2">// COMM LOG</h2>
                    <div id="log-display" class="log-container text-xs font-mono p-2 rounded bg-black/50">
                        <p class="text-gray-400">[BOOT] Systems online...</p>
                    </div>
                </div>
            </section>

            <!-- ===== MAP TAB ===== -->
            <section id="map-tab-content" class="tab-content">
                <div class="retro-border secondary-panel-bg rounded-lg p-3">
                    <div class="flex justify-between items-center mb-2">
                        <h2 class="font-title text-xs text-green-400">// NAVIGATION</h2>
                        <div class="flex items-center gap-2">
                            <span class="text-xs text-gray-400">SYSTEM:</span>
                            <span id="system-name-display" class="text-xs text-yellow-400 font-bold">Orion's Anvil</span>
                        </div>
                    </div>

                    <!-- Map Timer -->
                    <div class="text-center mb-2 p-2 bg-black/30 rounded border border-red-500/50">
                        <p class="text-xs text-red-400">TIME TO INTERCEPT</p>
                        <p id="map-timer-display" class="text-2xl font-bold text-red-500 font-title">05:00</p>
                    </div>

                    <!-- Navigation Map -->
                    <div id="navigation-map" class="relative w-full aspect-square bg-black/50 rounded overflow-hidden border border-green-500/30">
                        <canvas id="title-starfield-canvas" class="absolute top-0 left-0 w-full h-full"></canvas>
                        <canvas id="map-overlay-canvas" class="absolute top-0 left-0 w-full h-full pointer-events-none"></canvas>

                        <!-- SVG Maps -->
                        <!-- Map 1: Orion's Anvil - Asteroid Belt & Forge -->
                        <svg id="map-display-1" class="absolute top-0 left-0 w-full h-full" viewBox="0 0 400 400" style="display: block;">
                            <defs>
                                <radialGradient id="star1" cx="50%" cy="50%" r="50%">
                                    <stop offset="0%" style="stop-color:#ffaa00;stop-opacity:1"/>
                                    <stop offset="100%" style="stop-color:#ff6600;stop-opacity:0"/>
                                </radialGradient>
                            </defs>
                            <!-- Asteroids -->
                            <ellipse cx="120" cy="180" rx="25" ry="18" fill="#4a4a4a" opacity="0.7"/>
                            <ellipse cx="180" cy="120" rx="15" ry="12" fill="#5a5a5a" opacity="0.6"/>
                            <ellipse cx="280" cy="200" rx="30" ry="20" fill="#3a3a3a" opacity="0.8"/>
                            <ellipse cx="220" cy="280" rx="20" ry="15" fill="#4a4a4a" opacity="0.7"/>
                            <ellipse cx="150" cy="250" rx="12" ry="10" fill="#5a5a5a" opacity="0.5"/>
                            <ellipse cx="320" cy="150" rx="18" ry="14" fill="#3a3a3a" opacity="0.6"/>
                            <!-- Forge Structure -->
                            <polygon points="200,140 180,180 220,180" fill="none" stroke="#ff6600" stroke-width="2" opacity="0.6"/>
                            <line x1="200" y1="140" x2="200" y2="100" stroke="#ff6600" stroke-width="1" opacity="0.4"/>
                            <circle cx="200" cy="160" r="8" fill="#ff6600" opacity="0.3">
                                <animate attributeName="opacity" values="0.3;0.6;0.3" dur="2s" repeatCount="indefinite"/>
                            </circle>
                            <!-- Navigation Points -->
                            <g id="ship-trail-group"></g>
                            <circle cx="50" cy="350" r="8" fill="#00ff41" opacity="0.8"/>
                            <circle cx="350" cy="50" r="10" fill="#ff4100" opacity="0.8"/>
                            <text x="50" y="380" fill="#00ff41" font-size="10" text-anchor="middle">START</text>
                            <text x="350" y="30" fill="#ff4100" font-size="10" text-anchor="middle">FREEDOM</text>
                            <g id="dillinger-ship-group">
                                <polygon points="0,-8 -5,8 5,8" fill="#00ffff" stroke="#ffffff" stroke-width="1"/>
                                <circle cx="0" cy="0" r="12" fill="none" stroke="#00ffff" stroke-width="1" opacity="0.5">
                                    <animate attributeName="r" values="12;18;12" dur="1.5s" repeatCount="indefinite"/>
                                    <animate attributeName="opacity" values="0.5;0.1;0.5" dur="1.5s" repeatCount="indefinite"/>
                                </circle>
                            </g>
                        </svg>
                        
                        <!-- Map 2: The Crimson Expanse - Red Nebula -->
                        <svg id="map-display-2" class="absolute top-0 left-0 w-full h-full" viewBox="0 0 400 400" style="display: none;">
                            <defs>
                                <radialGradient id="nebula2" cx="50%" cy="50%" r="60%">
                                    <stop offset="0%" style="stop-color:#ff3333;stop-opacity:0.4"/>
                                    <stop offset="50%" style="stop-color:#aa0000;stop-opacity:0.2"/>
                                    <stop offset="100%" style="stop-color:#330000;stop-opacity:0"/>
                                </radialGradient>
                                <radialGradient id="redstar" cx="50%" cy="50%" r="50%">
                                    <stop offset="0%" style="stop-color:#ff6666"/>
                                    <stop offset="70%" style="stop-color:#cc0000"/>
                                    <stop offset="100%" style="stop-color:#660000;stop-opacity:0"/>
                                </radialGradient>
                            </defs>
                            <!-- Nebula clouds -->
                            <ellipse cx="200" cy="200" rx="150" ry="100" fill="url(#nebula2)"/>
                            <ellipse cx="150" cy="150" rx="80" ry="60" fill="url(#nebula2)" opacity="0.5"/>
                            <ellipse cx="280" cy="250" rx="90" ry="70" fill="url(#nebula2)" opacity="0.6"/>
                            <!-- Red Giant Star -->
                            <circle cx="250" cy="180" r="40" fill="url(#redstar)">
                                <animate attributeName="r" values="38;42;38" dur="3s" repeatCount="indefinite"/>
                            </circle>
                            <!-- Small planets -->
                            <circle cx="120" cy="280" r="8" fill="#884422"/>
                            <circle cx="320" cy="120" r="6" fill="#664433"/>
                            <!-- Navigation Points -->
                            <g id="ship-trail-group-2"></g>
                            <circle cx="50" cy="350" r="8" fill="#00ff41" opacity="0.8"/>
                            <circle cx="350" cy="50" r="10" fill="#ff4100" opacity="0.8"/>
                            <text x="50" y="380" fill="#00ff41" font-size="10" text-anchor="middle">START</text>
                            <text x="350" y="30" fill="#ff4100" font-size="10" text-anchor="middle">FREEDOM</text>
                            <g id="dillinger-ship-group-2">
                                <polygon points="0,-8 -5,8 5,8" fill="#00ffff" stroke="#ffffff" stroke-width="1"/>
                                <circle cx="0" cy="0" r="12" fill="none" stroke="#00ffff" stroke-width="1" opacity="0.5">
                                    <animate attributeName="r" values="12;18;12" dur="1.5s" repeatCount="indefinite"/>
                                    <animate attributeName="opacity" values="0.5;0.1;0.5" dur="1.5s" repeatCount="indefinite"/>
                                </circle>
                            </g>
                        </svg>
                        
                        <!-- Map 3: Hyperion Reach - Gas Giant with Moons -->
                        <svg id="map-display-3" class="absolute top-0 left-0 w-full h-full" viewBox="0 0 400 400" style="display: none;">
                            <defs>
                                <linearGradient id="gasgiant" x1="0%" y1="0%" x2="100%" y2="0%">
                                    <stop offset="0%" style="stop-color:#dd9944"/>
                                    <stop offset="30%" style="stop-color:#cc7733"/>
                                    <stop offset="50%" style="stop-color:#bb8844"/>
                                    <stop offset="70%" style="stop-color:#aa6622"/>
                                    <stop offset="100%" style="stop-color:#996633"/>
                                </linearGradient>
                            </defs>
                            <!-- Gas Giant -->
                            <circle cx="200" cy="200" r="70" fill="url(#gasgiant)"/>
                            <!-- Bands -->
                            <ellipse cx="200" cy="180" rx="68" ry="8" fill="#aa5500" opacity="0.4"/>
                            <ellipse cx="200" cy="210" rx="65" ry="6" fill="#cc8833" opacity="0.3"/>
                            <ellipse cx="200" cy="230" rx="60" ry="5" fill="#aa5500" opacity="0.4"/>
                            <!-- Ring -->
                            <ellipse cx="200" cy="200" rx="110" ry="25" fill="none" stroke="#ccaa77" stroke-width="8" opacity="0.3"/>
                            <!-- Moons -->
                            <circle cx="100" cy="150" r="12" fill="#888888"/>
                            <circle cx="320" cy="180" r="8" fill="#aaaaaa"/>
                            <circle cx="280" cy="300" r="10" fill="#777777"/>
                            <circle cx="130" cy="280" r="6" fill="#999999"/>
                            <!-- Moon orbits -->
                            <circle cx="200" cy="200" r="120" fill="none" stroke="#ffffff" stroke-width="0.5" opacity="0.2" stroke-dasharray="5,5"/>
                            <!-- Navigation Points -->
                            <g id="ship-trail-group-3"></g>
                            <circle cx="50" cy="350" r="8" fill="#00ff41" opacity="0.8"/>
                            <circle cx="350" cy="50" r="10" fill="#ff4100" opacity="0.8"/>
                            <text x="50" y="380" fill="#00ff41" font-size="10" text-anchor="middle">START</text>
                            <text x="350" y="30" fill="#ff4100" font-size="10" text-anchor="middle">FREEDOM</text>
                            <g id="dillinger-ship-group-3">
                                <polygon points="0,-8 -5,8 5,8" fill="#00ffff" stroke="#ffffff" stroke-width="1"/>
                                <circle cx="0" cy="0" r="12" fill="none" stroke="#00ffff" stroke-width="1" opacity="0.5">
                                    <animate attributeName="r" values="12;18;12" dur="1.5s" repeatCount="indefinite"/>
                                    <animate attributeName="opacity" values="0.5;0.1;0.5" dur="1.5s" repeatCount="indefinite"/>
                                </circle>
                            </g>
                        </svg>
                        
                        <!-- Map 4: Specter's Drift - Debris & Derelicts -->
                        <svg id="map-display-4" class="absolute top-0 left-0 w-full h-full" viewBox="0 0 400 400" style="display: none;">
                            <!-- Derelict Ship 1 -->
                            <g transform="translate(150, 150) rotate(25)">
                                <polygon points="0,-20 -8,15 8,15" fill="none" stroke="#446666" stroke-width="2" opacity="0.6"/>
                                <line x1="-12" y1="5" x2="-25" y2="0" stroke="#446666" stroke-width="1" opacity="0.4"/>
                                <line x1="12" y1="5" x2="25" y2="0" stroke="#446666" stroke-width="1" opacity="0.4"/>
                            </g>
                            <!-- Derelict Ship 2 -->
                            <g transform="translate(280, 220) rotate(-15)">
                                <rect x="-15" y="-8" width="30" height="16" fill="none" stroke="#445555" stroke-width="2" opacity="0.5"/>
                                <line x1="15" y1="0" x2="25" y2="0" stroke="#445555" stroke-width="1"/>
                            </g>
                            <!-- Debris -->
                            <rect x="100" y="250" width="8" height="3" fill="#334444" opacity="0.5" transform="rotate(45 104 251)"/>
                            <rect x="200" y="100" width="6" height="2" fill="#334444" opacity="0.4" transform="rotate(-30 203 101)"/>
                            <rect x="320" y="280" width="10" height="4" fill="#334444" opacity="0.6" transform="rotate(60 325 282)"/>
                            <polygon points="250,150 245,160 255,160" fill="#334444" opacity="0.4"/>
                            <polygon points="130,320 125,330 135,330" fill="#334444" opacity="0.5"/>
                            <!-- Ghost glow -->
                            <circle cx="200" cy="200" r="80" fill="none" stroke="#66ffff" stroke-width="1" opacity="0.1">
                                <animate attributeName="opacity" values="0.1;0.2;0.1" dur="4s" repeatCount="indefinite"/>
                            </circle>
                            <!-- Navigation Points -->
                            <g id="ship-trail-group-4"></g>
                            <circle cx="50" cy="350" r="8" fill="#00ff41" opacity="0.8"/>
                            <circle cx="350" cy="50" r="10" fill="#ff4100" opacity="0.8"/>
                            <text x="50" y="380" fill="#00ff41" font-size="10" text-anchor="middle">START</text>
                            <text x="350" y="30" fill="#ff4100" font-size="10" text-anchor="middle">FREEDOM</text>
                            <g id="dillinger-ship-group-4">
                                <polygon points="0,-8 -5,8 5,8" fill="#00ffff" stroke="#ffffff" stroke-width="1"/>
                                <circle cx="0" cy="0" r="12" fill="none" stroke="#00ffff" stroke-width="1" opacity="0.5">
                                    <animate attributeName="r" values="12;18;12" dur="1.5s" repeatCount="indefinite"/>
                                    <animate attributeName="opacity" values="0.5;0.1;0.5" dur="1.5s" repeatCount="indefinite"/>
                                </circle>
                            </g>
                        </svg>
                        
                        <!-- Map 5: The Cygnus Forge - Industrial Station -->
                        <svg id="map-display-5" class="absolute top-0 left-0 w-full h-full" viewBox="0 0 400 400" style="display: none;">
                            <!-- Central Station -->
                            <rect x="175" y="175" width="50" height="50" fill="#333333" stroke="#ffaa00" stroke-width="2"/>
                            <rect x="185" y="185" width="30" height="30" fill="#222222" stroke="#ff6600" stroke-width="1"/>
                            <!-- Solar Arrays -->
                            <rect x="120" y="190" width="50" height="8" fill="#224466" stroke="#4488aa" stroke-width="1"/>
                            <rect x="230" y="190" width="50" height="8" fill="#224466" stroke="#4488aa" stroke-width="1"/>
                            <!-- Mining Rigs -->
                            <g transform="translate(120, 120)">
                                <rect x="-5" y="-15" width="10" height="30" fill="#444444" stroke="#666666" stroke-width="1"/>
                                <circle cx="0" cy="-15" r="5" fill="#ff6600" opacity="0.6">
                                    <animate attributeName="opacity" values="0.6;1;0.6" dur="1s" repeatCount="indefinite"/>
                                </circle>
                            </g>
                            <g transform="translate(300, 280)">
                                <rect x="-5" y="-15" width="10" height="30" fill="#444444" stroke="#666666" stroke-width="1"/>
                                <circle cx="0" cy="-15" r="5" fill="#ff6600" opacity="0.6">
                                    <animate attributeName="opacity" values="0.6;1;0.6" dur="1.5s" repeatCount="indefinite"/>
                                </circle>
                            </g>
                            <!-- Cargo containers -->
                            <rect x="250" y="130" width="15" height="10" fill="#555555"/>
                            <rect x="270" y="130" width="15" height="10" fill="#555555"/>
                            <rect x="140" y="280" width="15" height="10" fill="#555555"/>
                            <!-- Energy beams -->
                            <line x1="200" y1="175" x2="120" y2="120" stroke="#ffaa00" stroke-width="1" opacity="0.3" stroke-dasharray="3,3">
                                <animate attributeName="opacity" values="0.3;0.6;0.3" dur="2s" repeatCount="indefinite"/>
                            </line>
                            <line x1="200" y1="225" x2="300" y2="280" stroke="#ffaa00" stroke-width="1" opacity="0.3" stroke-dasharray="3,3">
                                <animate attributeName="opacity" values="0.3;0.6;0.3" dur="2s" repeatCount="indefinite"/>
                            </line>
                            <!-- Navigation Points -->
                            <g id="ship-trail-group-5"></g>
                            <circle cx="50" cy="350" r="8" fill="#00ff41" opacity="0.8"/>
                            <circle cx="350" cy="50" r="10" fill="#ff4100" opacity="0.8"/>
                            <text x="50" y="380" fill="#00ff41" font-size="10" text-anchor="middle">START</text>
                            <text x="350" y="30" fill="#ff4100" font-size="10" text-anchor="middle">FREEDOM</text>
                            <g id="dillinger-ship-group-5">
                                <polygon points="0,-8 -5,8 5,8" fill="#00ffff" stroke="#ffffff" stroke-width="1"/>
                                <circle cx="0" cy="0" r="12" fill="none" stroke="#00ffff" stroke-width="1" opacity="0.5">
                                    <animate attributeName="r" values="12;18;12" dur="1.5s" repeatCount="indefinite"/>
                                    <animate attributeName="opacity" values="0.5;0.1;0.5" dur="1.5s" repeatCount="indefinite"/>
                                </circle>
                            </g>
                        </svg>
                        
                        <!-- Map 6: Leviathan's Cradle - Cosmic Creature -->
                        <svg id="map-display-6" class="absolute top-0 left-0 w-full h-full" viewBox="0 0 400 400" style="display: none;">
                            <defs>
                                <radialGradient id="biolum" cx="50%" cy="50%" r="50%">
                                    <stop offset="0%" style="stop-color:#00ffaa;stop-opacity:0.6"/>
                                    <stop offset="100%" style="stop-color:#006644;stop-opacity:0"/>
                                </radialGradient>
                            </defs>
                            <!-- Leviathan silhouette -->
                            <path d="M100,200 Q120,150 180,160 Q220,140 260,170 Q300,160 330,200 Q340,230 320,250 Q280,280 220,270 Q160,290 120,260 Q90,240 100,200" 
                                  fill="none" stroke="#00aa88" stroke-width="3" opacity="0.4"/>
                            <!-- Eye -->
                            <circle cx="150" cy="190" r="8" fill="#00ffaa" opacity="0.7">
                                <animate attributeName="opacity" values="0.7;1;0.7" dur="3s" repeatCount="indefinite"/>
                            </circle>
                            <circle cx="150" cy="190" r="3" fill="#ffffff"/>
                            <!-- Bioluminescent spots -->
                            <circle cx="200" cy="180" r="15" fill="url(#biolum)">
                                <animate attributeName="opacity" values="0.5;0.8;0.5" dur="2s" repeatCount="indefinite"/>
                            </circle>
                            <circle cx="260" cy="200" r="12" fill="url(#biolum)">
                                <animate attributeName="opacity" values="0.5;0.8;0.5" dur="2.5s" repeatCount="indefinite"/>
                            </circle>
                            <circle cx="180" cy="230" r="10" fill="url(#biolum)">
                                <animate attributeName="opacity" values="0.5;0.8;0.5" dur="1.8s" repeatCount="indefinite"/>
                            </circle>
                            <circle cx="300" cy="220" r="8" fill="url(#biolum)">
                                <animate attributeName="opacity" values="0.5;0.8;0.5" dur="2.2s" repeatCount="indefinite"/>
                            </circle>
                            <!-- Tentacle hints -->
                            <path d="M120,260 Q100,300 80,320" fill="none" stroke="#00aa88" stroke-width="2" opacity="0.3"/>
                            <path d="M220,270 Q230,310 250,340" fill="none" stroke="#00aa88" stroke-width="2" opacity="0.3"/>
                            <!-- Organic debris -->
                            <ellipse cx="320" cy="120" rx="8" ry="5" fill="#006655" opacity="0.4"/>
                            <ellipse cx="80" cy="150" rx="6" ry="4" fill="#006655" opacity="0.3"/>
                            <!-- Navigation Points -->
                            <g id="ship-trail-group-6"></g>
                            <circle cx="50" cy="350" r="8" fill="#00ff41" opacity="0.8"/>
                            <circle cx="350" cy="50" r="10" fill="#ff4100" opacity="0.8"/>
                            <text x="50" y="380" fill="#00ff41" font-size="10" text-anchor="middle">START</text>
                            <text x="350" y="30" fill="#ff4100" font-size="10" text-anchor="middle">FREEDOM</text>
                            <g id="dillinger-ship-group-6">
                                <polygon points="0,-8 -5,8 5,8" fill="#00ffff" stroke="#ffffff" stroke-width="1"/>
                                <circle cx="0" cy="0" r="12" fill="none" stroke="#00ffff" stroke-width="1" opacity="0.5">
                                    <animate attributeName="r" values="12;18;12" dur="1.5s" repeatCount="indefinite"/>
                                    <animate attributeName="opacity" values="0.5;0.1;0.5" dur="1.5s" repeatCount="indefinite"/>
                                </circle>
                            </g>
                        </svg>
                    </div>

                    <!-- Map Aux Dashboard -->
                    <div class="map-aux-dashboard">
                        <div class="target-info-panel">
                            <h3>TARGET</h3>
                            <p>ID: <span id="target-id">UN-77-B</span></p>
                            <p>CLASS: <span id="target-class">Nebula Fragment</span></p>
                            <p>DIST: <span id="target-dist">1.2 AU</span></p>
                            <p>SIGNAL: <span id="target-signal">Weak EM</span></p>
                        </div>
                        <div class="radar-container">
                            <canvas id="radar-canvas"></canvas>
                        </div>
                        <div class="system-status-panel">
                            <h3>STATUS</h3>
                            <p>SHIELDS: <span class="text-green-400">ONLINE</span></p>
                            <p>WEAPONS: <span class="text-yellow-400">STANDBY</span></p>
                            <p>ENGINES: <span class="text-green-400">NOMINAL</span></p>
                            <p>LIFE SUP: <span class="text-green-400">98%</span></p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ===== ENGINES TAB ===== -->
            <section id="engines-tab-content" class="tab-content">
                <div class="retro-border secondary-panel-bg rounded-lg p-3 mb-3">
                    <h2 class="font-title text-xs text-green-400 mb-2">// PROPULSION BAY</h2>

                    <!-- Ship Visualization -->
                    <div class="relative w-full h-32 bg-black/50 rounded overflow-hidden mb-3 border border-cyan-500/30">
                        <canvas id="airstream-canvas" class="absolute top-0 left-0 w-full h-full"></canvas>
                        <div class="absolute inset-0 flex items-center justify-center">
                            <svg viewBox="0 0 100 60" class="w-24 h-16 sail-power-active">
                                <polygon points="50,5 10,55 50,45 90,55" fill="none" stroke="#00ffff" stroke-width="2"/>
                                <line x1="50" y1="5" x2="50" y2="45" stroke="#00ffff" stroke-width="1"/>
                            </svg>
                        </div>
                    </div>

                    <!-- Power Stats -->
                    <div class="grid grid-cols-2 gap-3 mb-3">
                        <div class="text-center p-2 bg-black/30 rounded border border-cyan-500/30">
                            <p class="text-xs text-gray-400">TOTAL POWER</p>
                            <p id="total-power-display" class="text-2xl font-bold text-cyan-400">0</p>
                        </div>
                        <div class="text-center p-2 bg-black/30 rounded border border-green-500/30">
                            <p class="text-xs text-gray-400">COOLDOWN</p>
                            <p id="cooldown-timer" class="text-2xl font-bold text-green-400">READY</p>
                        </div>
                    </div>

                    <!-- Balances -->
                    <div class="grid grid-cols-2 gap-3 mb-3 text-xs">
                        <div class="p-2 bg-black/30 rounded border border-yellow-500/30">
                            <span class="text-yellow-400">PHOTONS:</span>
                            <span id="photon-balance-engines" class="text-white font-bold ml-1">0</span>
                        </div>
                        <div class="p-2 bg-black/30 rounded border border-cyan-500/30">
                            <span class="text-cyan-400">LIGHTYEARS:</span>
                            <span id="lightyear-balance-engines" class="text-white font-bold ml-1">0</span>
                        </div>
                    </div>

                    <!-- Craft Buttons -->
                    <div class="grid grid-cols-2 gap-3 mb-3">
                        <button id="craft-sail-button" class="retro-button p-3 rounded text-center">
                            <i class="fas fa-solar-panel text-2xl text-cyan-400 mb-1"></i>
                            <p class="text-xs text-white font-bold">CRAFT SAIL</p>
                            <p class="text-xs text-yellow-400">250 Photons</p>
                        </button>
                        <button id="craft-battery-button" class="retro-button p-3 rounded text-center">
                            <i class="fas fa-battery-full text-2xl text-yellow-400 mb-1"></i>
                            <p class="text-xs text-white font-bold">CRAFT BATTERY</p>
                            <p class="text-xs text-cyan-400">5,000 LY</p>
                        </button>
                    </div>

                    <!-- Slot Ratios -->
                    <div class="mb-3">
                        <div class="flex justify-between text-xs mb-1">
                            <span class="text-cyan-400">SAILS</span>
                            <span class="text-yellow-400">BATTERIES</span>
                        </div>
                        <div class="h-2 bg-black/50 rounded-full overflow-hidden flex">
                            <div id="sail-ratio-bar" class="bg-cyan-400 h-full transition-all" style="width: 0%;"></div>
                            <div id="battery-ratio-bar" class="bg-yellow-400 h-full transition-all" style="width: 0%;"></div>
                        </div>
                    </div>
                </div>

                <!-- Inventory Slots -->
                <div class="retro-border secondary-panel-bg rounded-lg p-3">
                    <h2 class="font-title text-xs text-green-400 mb-2">// RADIATION CHAMBER</h2>
                    <div class="fuse-box-panel">
                        <div id="inventory-slots" class="grid grid-cols-4 gap-3">
                            <!-- Slots rendered by JS -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- ===== ACTION TAB ===== -->
            <section id="action-tab-content" class="tab-content">
                <div class="retro-border secondary-panel-bg rounded-lg p-3 mb-3">
                    <h2 class="font-title text-xs text-green-400 mb-2">// TACTICAL OPTIONS</h2>

                    <!-- Encounter Debrief -->
                    <div id="encounter-debrief-panel" class="hidden mb-3 p-3 bg-black/50 rounded border border-yellow-500/50">
                        <p class="text-xs text-yellow-400 font-bold mb-1">DEBRIEF:</p>
                        <p id="encounter-debrief-text" class="text-xs text-gray-300"></p>
                    </div>

                    <!-- Blackhole Entry -->
                    <div id="minigame-prompt" class="p-3 bg-black/50 rounded border border-purple-500/50 mb-3">
                        <h3 class="text-sm text-purple-400 font-bold mb-2">
                            <i class="fas fa-atom mr-2"></i>BLACK HOLE JUMP
                        </h3>
                        <p class="text-xs text-gray-400 mb-3">
                            Risk everything for a massive lightyear boost. Costs 250,000 LY and destroys all sails. Navigate the warp tunnel to escape!
                        </p>
                        <button id="enter-blackhole-button" class="retro-button w-full p-2 rounded text-purple-400 border-purple-500">
                            ENTER BLACK HOLE
                        </button>
                    </div>

                    <!-- Warp Minigame Container -->
                    <div id="minigame-container" class="hidden">
                        <div class="warp-game-container warp-game-font">
                            <div id="warp-gameView" class="flex-grow relative">
                                <div id="warp-viewContainer" class="w-full h-full">
                                    <canvas id="warp-gameCanvas"></canvas>
                                </div>
                            </div>
                            <div class="p-3 bg-black/80 border-t-2 border-orange-500">
                                <input type="range" id="warp-slider" class="warp-slider w-full mb-3" min="-100" max="100" value="0">
                                <button id="warp-out-button" class="warp-control-button w-full py-3 text-xl bg-green-900 border-2 border-green-500 text-green-400 rounded">
                                    WARP OUT & CLAIM
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Test Buttons (Dev) -->
                <div class="retro-border secondary-panel-bg rounded-lg p-3">
                    <h2 class="font-title text-xs text-gray-500 mb-2">// DEV TOOLS</h2>
                    <div class="grid grid-cols-3 gap-2">
                        <button id="test-photons-button" class="retro-button p-2 rounded text-xs text-yellow-400 border-yellow-500/50">
                            +1K PHOTONS
                        </button>
                        <button id="test-lightyears-button" class="retro-button p-2 rounded text-xs text-cyan-400 border-cyan-500/50">
                            +250K LY
                        </button>
                        <button id="test-encounter-button" class="retro-button p-2 rounded text-xs text-red-400 border-red-500/50">
                            ENCOUNTER
                        </button>
                    </div>
                </div>
            </section>

            <!-- ===== BRIEFING TAB ===== -->
            <section id="briefing-tab-content" class="tab-content">
                <div class="retro-border secondary-panel-bg rounded-lg p-3 mb-3">
                    <h2 class="font-title text-xs text-green-400 mb-3">// MISSION BRIEFING</h2>

                    <div class="space-y-4 text-xs text-gray-300">
                        <div class="p-3 bg-black/30 rounded border-l-2 border-yellow-500">
                            <h3 class="text-yellow-400 font-bold mb-1">OBJECTIVE</h3>
                            <p>Travel 1,000,000 lightyears to escape the law. Collect outstanding warrants to prove your infamy.</p>
                        </div>

                        <div class="p-3 bg-black/30 rounded border-l-2 border-cyan-500">
                            <h3 class="text-cyan-400 font-bold mb-1">SOLAR SAILS</h3>
                            <p>Craft sails to generate lightyears. Power scales with sun intensity. Sails degrade over time and must be jettisoned when broken.</p>
                        </div>

                        <div class="p-3 bg-black/30 rounded border-l-2 border-yellow-500">
                            <h3 class="text-yellow-400 font-bold mb-1">PHOTON BATTERIES</h3>
                            <p>Generate passive photon income. Rate scales with ETH substrate price. Essential for continuous sail production.</p>
                        </div>

                        <div class="p-3 bg-black/30 rounded border-l-2 border-red-500">
                            <h3 class="text-red-400 font-bold mb-1">ENCOUNTERS</h3>
                            <p>Random events trigger during crafting. Risk it for rewards or play it safe. Each has different odds and payouts.</p>
                        </div>

                        <div class="p-3 bg-black/30 rounded border-l-2 border-purple-500">
                            <h3 class="text-purple-400 font-bold mb-1">BLACK HOLE</h3>
                            <p>High-risk minigame. Costs 250K LY and all sails. Navigate the warp tunnel to claim massive distance. Failure ends the run.</p>
                        </div>
                    </div>
                </div>

                <!-- Settings -->
                <div class="retro-border secondary-panel-bg rounded-lg p-3">
                    <h2 class="font-title text-xs text-green-400 mb-3">// SETTINGS</h2>

                    <div class="flex justify-between items-center mb-3">
                        <span class="text-xs text-gray-400">SYSTEM MODE</span>
                        <button id="cycle-mode-button" class="retro-button px-3 py-1 rounded text-xs">
                            CYCLE MODE
                        </button>
                    </div>

                    <div class="flex justify-center gap-4 mb-3">
                        <button id="mute-music-button" class="audio-control-button">
                            <i id="mute-music-icon" class="fas fa-volume-up"></i>
                        </button>
                        <button id="mute-sfx-button" class="audio-control-button">
                            <i id="mute-sfx-icon" class="fas fa-volume-up"></i>
                        </button>
                    </div>

                    <div class="flex justify-between items-center mb-3">
                        <span class="text-xs text-gray-400">SCANNER</span>
                        <button id="toggle-scanner-btn" class="retro-button px-3 py-1 rounded text-xs">
                            TOGGLE
                        </button>
                    </div>

                    <!-- Data Scanner -->
                    <div class="data-scanner">
                        <div class="scanner-bar"></div>
                        <div class="text-stream">SYSTEM SCAN: OK :: STARDIVE CORES: NOMINAL</div>
                    </div>

                    <!-- Reset -->
                    <div class="mt-4 pt-4 border-t border-red-500/30">
                        <button id="reset-prompt-button" class="retro-button w-full p-2 rounded text-red-400 border-red-500/50">
                            <i class="fas fa-skull mr-2"></i>ABORT MISSION
                        </button>
                    </div>
                </div>
            </section>

        </div>
    </main>

    <!-- ========================================= -->
    <!-- BOTTOM NAVIGATION -->
    <!-- ========================================= -->
    <nav id="bottom-nav-bar" class="bottom-nav hidden">
        <button id="nav-vitals" class="nav-button active">
            <i class="fas fa-heartbeat"></i>
            <span>Vitals</span>
        </button>
        <button id="nav-map" class="nav-button">
            <i class="fas fa-map-marked-alt"></i>
            <span>Map</span>
        </button>
        <button id="nav-engines" class="nav-button">
            <i class="fas fa-cogs"></i>
            <span>Engines</span>
        </button>
        <button id="nav-action" class="nav-button">
            <i class="fas fa-crosshairs"></i>
            <span>Action</span>
        </button>
        <button id="nav-briefing" class="nav-button">
            <i class="fas fa-file-alt"></i>
            <span>Brief</span>
        </button>
    </nav>

    <!-- ========================================= -->
    <!-- MODALS -->
    <!-- ========================================= -->

    <!-- Encounter Modal -->
    <div id="encounter-modal" class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4 hidden">
        <div class="retro-border secondary-panel-bg rounded-lg p-4 max-w-sm w-full">
            <h2 class="font-title text-sm text-red-400 mb-3 text-center">
                <i class="fas fa-exclamation-triangle mr-2"></i>ENCOUNTER
            </h2>
            <p id="encounter-description" class="text-sm text-gray-300 mb-4 text-center"></p>
            <div class="grid grid-cols-2 gap-3">
                <button id="encounter-avoid" class="retro-button p-2 rounded text-gray-400">
                    AVOID
                </button>
                <button id="encounter-risk-it" class="retro-button p-2 rounded text-yellow-400 border-yellow-500">
                    RISK IT
                </button>
            </div>
        </div>
    </div>

    <!-- Win Modal -->
    <div id="win-message" class="fixed inset-0 z-50 flex items-center justify-center bg-black/90 p-4 hidden">
        <div class="retro-border secondary-panel-bg rounded-lg p-6 max-w-sm w-full text-center">
            <h2 class="font-title text-xl text-green-400 mb-3">FREEDOM!</h2>
            <p class="text-gray-300 mb-4">You've escaped the law... for now. Claim your warrant and continue the run!</p>
            <button id="claim-warrant-button" class="retro-button w-full p-3 rounded text-yellow-400 border-yellow-500 mb-2">
                <i class="fas fa-trophy mr-2"></i>CLAIM WARRANT
            </button>
            <button id="win-reset-button" class="retro-button w-full p-2 rounded text-gray-400">
                NEW GAME
            </button>
        </div>
    </div>

    <!-- Game Over Modal -->
    <div id="game-over-message" class="fixed inset-0 z-50 flex items-center justify-center bg-black/90 p-4 hidden">
        <div class="retro-border secondary-panel-bg rounded-lg p-6 max-w-sm w-full text-center" style="border-color: var(--neon-red);">
            <h2 class="font-title text-xl text-red-400 mb-3">CAPTURED</h2>
            <p class="text-gray-300 mb-4">The authorities have caught up. Your run ends here.</p>
            <button id="game-over-reset-button" class="retro-button w-full p-3 rounded text-red-400 border-red-500">
                <i class="fas fa-redo mr-2"></i>TRY AGAIN
            </button>
        </div>
    </div>

    <!-- Reset Confirmation Modal -->
    <div id="reset-confirm-modal" class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4 hidden">
        <div class="retro-border secondary-panel-bg rounded-lg p-4 max-w-sm w-full">
            <h2 class="font-title text-sm text-red-400 mb-3 text-center">ABORT MISSION?</h2>
            <p class="text-sm text-gray-300 mb-4 text-center">All progress will be lost. Are you sure?</p>
            <div class="grid grid-cols-2 gap-3">
                <button id="reset-cancel-button" class="retro-button p-2 rounded text-gray-400">
                    CANCEL
                </button>
                <button id="reset-confirm-button" class="retro-button p-2 rounded text-red-400 border-red-500">
                    CONFIRM
                </button>
            </div>
        </div>
    </div>

</body>
</html>
